package active.scanner;

import active.http.HttpClient;
import active.model.ApiEndpoint;
import active.model.VulnerabilityReport;

import java.util.List;

/**
 * Plugin interface for vulnerability scanners.
 * Implementations should detect specific types of vulnerabilities in API endpoints.
 *
 * <p>Scanners are designed to be:
 * <ul>
 *   <li>Independent - Each scanner focuses on a specific vulnerability type</li>
 *   <li>Composable - Multiple scanners can be applied to the same endpoint</li>
 *   <li>Configurable - Scanners can have their own configuration</li>
 * </ul>
 */
public interface VulnerabilityScanner {

    /**
     * Get the unique identifier for this scanner.
     *
     * @return the scanner ID
     */
    String getId();

    /**
     * Get the human-readable name of this scanner.
     *
     * @return the scanner name
     */
    String getName();

    /**
     * Get the description of what this scanner detects.
     *
     * @return the scanner description
     */
    String getDescription();

    /**
     * Get the vulnerability type(s) this scanner can detect.
     *
     * @return list of vulnerability types
     */
    List<VulnerabilityReport.VulnerabilityType> getDetectedVulnerabilities();

    /**
     * Check if this scanner is applicable to the given endpoint.
     * Scanners can filter which endpoints they test based on various criteria
     * (e.g., HTTP method, path patterns, presence of parameters).
     *
     * @param endpoint the API endpoint to check
     * @return true if this scanner should test the endpoint
     */
    boolean isApplicable(ApiEndpoint endpoint);

    /**
     * Scan an API endpoint for vulnerabilities.
     *
     * @param endpoint the endpoint to scan
     * @param httpClient the HTTP client to use for testing
     * @param context the scan context with configuration and state
     * @return scan result with detected vulnerabilities
     */
    ScanResult scan(ApiEndpoint endpoint, HttpClient httpClient, ScanContext context);

    /**
     * Get the scanner configuration.
     *
     * @return the scanner configuration
     */
    ScannerConfig getConfig();

    /**
     * Set the scanner configuration.
     *
     * @param config the scanner configuration
     */
    void setConfig(ScannerConfig config);
}
