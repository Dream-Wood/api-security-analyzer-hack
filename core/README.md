# Core Module / –ú–æ–¥—É–ª—å Core

–Ø–¥—Ä–æ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ API - —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ API —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø–∞–∫–µ—Ç–æ–≤)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏](#—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏)

## üéØ –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å `core` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- üîç **–ê–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ HTTP-–∑–∞–ø—Ä–æ—Å–∞–º–∏
- üõ°Ô∏è **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- üìù **–ü–∞—Ä—Å–∏–Ω–≥ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π** - –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è OpenAPI –∏ AsyncAPI
- üîê **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ì–û–°–¢** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CryptoPro JCSP
- üîå **–ü–ª–∞–≥–∏–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–∫–∞–Ω–µ—Ä–æ–≤ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
core/
‚îú‚îÄ‚îÄ active/              # –ê–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ scanner/         # –°–∫–∞–Ω–µ—Ä—ã —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π (–ø–ª–∞–≥–∏–Ω—ã)
‚îÇ   ‚îú‚îÄ‚îÄ http/            # HTTP –∫–ª–∏–µ–Ω—Ç—ã (TLS, GOST)
‚îÇ   ‚îú‚îÄ‚îÄ auth/            # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ validator/       # –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ model/           # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
‚îú‚îÄ‚îÄ validator/           # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
‚îú‚îÄ‚îÄ parser/              # –ü–∞—Ä—Å–µ—Ä—ã —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π
‚îú‚îÄ‚îÄ model/               # –û–±—â–∏–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ util/                # –£—Ç–∏–ª–∏—Ç—ã
```

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –î–≤–∏–∂–æ–∫ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

**`ActiveAnalysisEngine`** - –≥–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–∫–∞–Ω–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ ServiceLoader
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ TLS –∏ –ì–û–°–¢ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (LOW, MEDIUM, HIGH, AGGRESSIVE)
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–µ–∫ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```java
// –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
AnalysisConfig config = AnalysisConfig.builder()
    .cryptoProtocol(HttpClient.CryptoProtocol.STANDARD_TLS)
    .verifySsl(true)
    .maxParallelScans(4)
    .scanIntensity("MEDIUM")
    .progressListener(new MyProgressListener())
    .build();

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–≤–∏–∂–∫–∞
ActiveAnalysisEngine engine = new ActiveAnalysisEngine(config);

// –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
List<ApiEndpoint> endpoints = extractFromSpec(openAPI);
ScanContext context = new ScanContext(baseUrl);
AnalysisReport report = engine.scanEndpoints(endpoints, context);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
System.out.println("–ù–∞–π–¥–µ–Ω–æ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π: " + report.getTotalVulnerabilityCount());
System.out.println("–£—è–∑–≤–∏–º—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤: " + report.getVulnerableEndpointCount());

// –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
engine.shutdown();
```

### 2. HTTP –∫–ª–∏–µ–Ω—Ç—ã

**`HttpClient`** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è HTTP –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

#### StandardHttpClient
–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π HTTP –∫–ª–∏–µ–Ω—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π TLS/SSL:
```java
HttpClientConfig config = HttpClientConfig.builder()
    .cryptoProtocol(HttpClient.CryptoProtocol.STANDARD_TLS)
    .connectTimeout(Duration.ofSeconds(30))
    .readTimeout(Duration.ofSeconds(30))
    .followRedirects(true)
    .verifySsl(true)
    .build();

HttpClient client = HttpClientFactory.createClient(config);
```

#### CryptoProHttpClient
HTTP –∫–ª–∏–µ–Ω—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–æ—Å—Å–∏–π—Å–∫–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ì–û–°–¢:
```java
HttpClientConfig config = HttpClientConfig.builder()
    .cryptoProtocol(HttpClient.CryptoProtocol.CRYPTOPRO_JCSP)
    .addCustomSetting("pfxPath", "/path/to/certificate.pfx")
    .addCustomSetting("pfxPassword", "password")
    .build();

HttpClient client = HttpClientFactory.createClient(config);
```

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∫–ª—é—á–µ–π:**
- üìÅ **PFX** - PKCS#12 —Ñ–∞–π–ª—ã (`.pfx`, `.p12`)
- üîê **JCP** - CryptoPro Java CSP —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- üè™ **Cacerts** - —Å–∏—Å—Ç–µ–º–Ω–æ–µ Java —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

### 3. –°–∫–∞–Ω–µ—Ä—ã —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

**`VulnerabilityScanner`** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–ª–∞–≥–∏–Ω–∞ –¥–ª—è —Å–∫–∞–Ω–µ—Ä–æ–≤ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- üîå –ü–ª–∞–≥–∏–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —á–µ—Ä–µ–∑ Java ServiceLoader
- üéØ –ö–∞–∂–¥—ã–π —Å–∫–∞–Ω–µ—Ä —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Ç–∏–ø–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- ‚öôÔ∏è –ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∫–∞–Ω–µ—Ä–∞
- üìä –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏

**–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–∫–∞–Ω–µ—Ä–∞:**

1. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `VulnerabilityScanner`:
```java
package com.example.scanners;

public class MyCustomScanner extends AbstractScanner {

    @Override
    public String getId() {
        return "my-custom-scanner";
    }

    @Override
    public String getName() {
        return "My Custom Scanner";
    }

    @Override
    public String getDescription() {
        return "–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—É—é —É—è–∑–≤–∏–º–æ—Å—Ç—å";
    }

    @Override
    public List<VulnerabilityReport.VulnerabilityType> getDetectedVulnerabilities() {
        return List.of(VulnerabilityReport.VulnerabilityType.OTHER);
    }

    @Override
    public boolean isApplicable(ApiEndpoint endpoint) {
        // –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –∫–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Å–∫–∞–Ω–µ—Ä
        return endpoint.getMethod().equals("POST");
    }

    @Override
    protected ScanResult performScan(ApiEndpoint endpoint, HttpClient httpClient, ScanContext context) {
        // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        TestRequest request = buildTestRequest(endpoint, context);
        TestResponse response = httpClient.execute(request);

        // –ê–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞
        if (isVulnerable(response)) {
            VulnerabilityReport vuln = createVulnerabilityReport(endpoint, request, response);
            return ScanResult.withVulnerabilities(List.of(vuln));
        }

        return ScanResult.clean();
    }
}
```

2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ —Å–∫–∞–Ω–µ—Ä —á–µ—Ä–µ–∑ ServiceLoader:

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `META-INF/services/active.scanner.VulnerabilityScanner`:
```
com.example.scanners.MyCustomScanner
```

### 4. –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**`SecurityValidator`** - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–±–ª–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Ö.

**–ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ –∞—Å–ø–µ–∫—Ç—ã:**
- üîê –ù–∞–ª–∏—á–∏–µ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å—Ö–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- üîí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS –≤–º–µ—Å—Ç–æ HTTP
- ‚ö†Ô∏è –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (Basic Auth)
- üîë API –∫–ª—é—á–∏ –≤ query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö
- üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (POST, PUT, DELETE)
- üö® –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ IDOR —É—è–∑–≤–∏–º–æ—Å—Ç–∏

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```java
OpenAPI openAPI = new OpenAPIV3Parser().read("api-spec.yaml");
SecurityValidator validator = new SecurityValidator(openAPI);
List<ValidationFinding> findings = validator.validate();

// –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏
Map<Severity, Long> bySeverity = findings.stream()
    .collect(Collectors.groupingBy(
        ValidationFinding::getSeverity,
        Collectors.counting()
    ));

System.out.println("–ö—Ä–∏—Ç–∏—á–Ω—ã—Ö: " + bySeverity.get(Severity.HIGH));
System.out.println("–°—Ä–µ–¥–Ω–∏—Ö: " + bySeverity.get(Severity.MEDIUM));
```

### 5. –ü–∞—Ä—Å–µ—Ä—ã —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π

**`OpenApiLoader`** - –∑–∞–≥—Ä—É–∑—á–∏–∫ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- üìÇ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ URL
- üîó –ü–æ–ª–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ ($ref)
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

**–ü—Ä–∏–º–µ—Ä:**
```java
OpenApiLoader loader = new OpenApiLoader();
OpenApiLoader.LoadResult result = loader.load("api-spec.yaml");

if (result.isSuccessful()) {
    OpenAPI openAPI = result.getOpenAPI();
    System.out.println("–ó–∞–≥—Ä—É–∂–µ–Ω–æ –æ–ø–µ—Ä–∞—Ü–∏–π: " + openAPI.getPaths().size());
} else {
    System.err.println("–û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏:");
    result.getMessages().forEach(System.err::println);
}
```

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤

### active.* - –ê–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑

| –ü–∞–∫–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| `active` | –ì–ª–∞–≤–Ω—ã–π –¥–≤–∏–∂–æ–∫ –∞–Ω–∞–ª–∏–∑–∞, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |
| `active.scanner` | –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã —Å–∫–∞–Ω–µ—Ä–æ–≤ |
| `active.http` | HTTP –∫–ª–∏–µ–Ω—Ç—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |
| `active.http.ssl` | SSL/TLS –∏ GOST –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è |
| `active.http.ssl.store` | –•—Ä–∞–Ω–∏–ª–∏—â–∞ –∫–ª—é—á–µ–π (PFX, JCP, cacerts) |
| `active.auth` | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| `active.validator` | –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –∏ —Ñ–∞–∑–∑–∏–Ω–≥ |
| `active.model` | –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, –∑–∞–ø—Ä–æ—Å—ã, –æ—Ç—á–µ—Ç—ã) |

### validator.* - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

| –ü–∞–∫–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| `validator` | –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ |

### parser.* - –ü–∞—Ä—Å–µ—Ä—ã

| –ü–∞–∫–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| `parser` | –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π |

### model.* - –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

| –ü–∞–∫–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| `model` | –û–±—â–∏–µ –º–æ–¥–µ–ª–∏ (–æ–ø–µ—Ä–∞—Ü–∏–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏) |

### util.* - –£—Ç–∏–ª–∏—Ç—ã

| –ü–∞–∫–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| `util` | –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ |

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏–∑–∞

```java
import active.ActiveAnalysisEngine;
import active.scanner.ScanContext;
import parser.OpenApiLoader;
import validator.SecurityValidator;

// 1. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
OpenApiLoader loader = new OpenApiLoader();
OpenApiLoader.LoadResult loadResult = loader.load("openapi.yaml");

if (!loadResult.isSuccessful()) {
    System.err.println("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏");
    return;
}

OpenAPI spec = loadResult.getOpenAPI();

// 2. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
SecurityValidator staticValidator = new SecurityValidator(spec);
List<ValidationFinding> staticFindings = staticValidator.validate();
System.out.println("–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º: " + staticFindings.size());

// 3. –ê–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑
AnalysisConfig config = AnalysisConfig.builder()
    .cryptoProtocol(HttpClient.CryptoProtocol.STANDARD_TLS)
    .scanIntensity("MEDIUM")
    .maxParallelScans(4)
    .build();

ActiveAnalysisEngine engine = new ActiveAnalysisEngine(config);

// –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
List<ApiEndpoint> endpoints = extractEndpoints(spec, "https://api.example.com");

// –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
ScanContext context = new ScanContext("https://api.example.com");
AnalysisReport report = engine.scanEndpoints(endpoints, context);

// 4. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
System.out.println("\n=== –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ ===");
System.out.println("–ü—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤: " + report.getEndpointCount());
System.out.println("–ù–∞–π–¥–µ–Ω–æ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π: " + report.getTotalVulnerabilityCount());

// –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø—É —É—è–∑–≤–∏–º–æ—Å—Ç–∏
Map<VulnerabilityReport.VulnerabilityType, Long> byType =
    report.getVulnerabilityCountByType();
byType.forEach((type, count) ->
    System.out.println("  " + type + ": " + count)
);

// –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏
Map<Severity, Long> bySeverity = report.getVulnerabilityCountBySeverity();
System.out.println("\n–ü–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏:");
bySeverity.forEach((severity, count) ->
    System.out.println("  " + severity + ": " + count)
);

// 5. –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
engine.shutdown();
```

## üîå –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–∫–∞–Ω–µ—Ä–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

1. **–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å —Å–∫–∞–Ω–µ—Ä–∞:**
```java
package com.example.scanners;

import active.scanner.AbstractScanner;
import active.scanner.ScanResult;
import active.model.*;

public class CustomInjectionScanner extends AbstractScanner {

    public CustomInjectionScanner() {
        super(ScannerConfig.builder()
            .enabled(true)
            .maxTestsPerEndpoint(5)
            .timeoutSeconds(30)
            .build());
    }

    @Override
    public String getId() {
        return "custom-injection";
    }

    @Override
    public String getName() {
        return "Custom Injection Scanner";
    }

    @Override
    public String getDescription() {
        return "–û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∏–Ω—ä–µ–∫—Ü–∏–∏";
    }

    @Override
    public List<VulnerabilityReport.VulnerabilityType> getDetectedVulnerabilities() {
        return List.of(VulnerabilityReport.VulnerabilityType.INJECTION);
    }

    @Override
    public boolean isApplicable(ApiEndpoint endpoint) {
        // –ü—Ä–∏–º–µ–Ω—è—Ç—å –∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
        return endpoint.hasParameters();
    }

    @Override
    protected ScanResult performScan(ApiEndpoint endpoint,
                                     HttpClient httpClient,
                                     ScanContext context) {
        List<VulnerabilityReport> vulnerabilities = new ArrayList<>();

        // –°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–µ–π–ª–æ–∞–¥–æ–≤
        List<String> payloads = List.of(
            "'; DROP TABLE users--",
            "<script>alert('xss')</script>",
            "../../../etc/passwd"
        );

        for (String payload : payloads) {
            TestRequest request = buildRequestWithPayload(endpoint, payload, context);
            TestResponse response = httpClient.execute(request);

            if (detectVulnerability(response, payload)) {
                VulnerabilityReport vuln = VulnerabilityReport.builder()
                    .type(VulnerabilityReport.VulnerabilityType.INJECTION)
                    .severity(Severity.HIGH)
                    .endpoint(endpoint.getPath())
                    .method(endpoint.getMethod())
                    .details("–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å –∏–Ω—ä–µ–∫—Ü–∏–∏ —Å –ø–µ–π–ª–æ–∞–¥–æ–º: " + payload)
                    .evidence(response.getBody())
                    .request(request)
                    .response(response)
                    .build();

                vulnerabilities.add(vuln);
            }
        }

        return vulnerabilities.isEmpty()
            ? ScanResult.clean()
            : ScanResult.withVulnerabilities(vulnerabilities);
    }

    private boolean detectVulnerability(TestResponse response, String payload) {
        // –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏
        return response.getStatusCode() == 500
            || response.getBody().contains(payload);
    }
}
```

2. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ ServiceLoader:**

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `src/main/resources/META-INF/services/active.scanner.VulnerabilityScanner`:
```
com.example.scanners.CustomInjectionScanner
```

3. **–°–∫–∞–Ω–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è** –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ `ActiveAnalysisEngine`.

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ HTTP –∫–ª–∏–µ–Ω—Ç–∞

```java
public class MyCustomHttpClient implements HttpClient {

    @Override
    public TestResponse execute(TestRequest request) {
        // –í–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
        return new TestResponse(200, "OK", headers, body);
    }

    @Override
    public CryptoProtocol getCryptoProtocol() {
        return CryptoProtocol.CUSTOM;
    }

    @Override
    public boolean supports(String url) {
        return url.startsWith("https://");
    }

    @Override
    public void close() {
        // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
    }
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞

```java
public class MyCustomValidator implements ContractValidator {

    private final OpenAPI openAPI;

    public MyCustomValidator(OpenAPI openAPI) {
        this.openAPI = openAPI;
    }

    @Override
    public List<ValidationFinding> validate() {
        List<ValidationFinding> findings = new ArrayList<>();

        // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
        for (Map.Entry<String, PathItem> entry : openAPI.getPaths().entrySet()) {
            String path = entry.getKey();
            PathItem pathItem = entry.getValue();

            // –ü—Ä–æ–≤–µ—Ä–∫–∞...
            if (hasIssue(pathItem)) {
                findings.add(ValidationFinding.builder()
                    .severity(Severity.MEDIUM)
                    .category(FindingCategory.SECURITY)
                    .type("CUSTOM_ISSUE")
                    .path(path)
                    .details("–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞")
                    .recommendation("–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é")
                    .build());
            }
        }

        return findings;
    }
}
```

